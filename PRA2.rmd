---
title: 'Tipología y ciclo de vida de los datos'
subtitle: 'PRÁCTICA 2: Limpieza y análisis de datos'
author: "Autores: Raúl Vicente Ferrer y Carmen Lobato Cassinello"
date: "Enero 2022"
output:
  pdf_document:
    highlight: zenburn
    toc: yes
header-includes:
  - \usepackage {hyperref}
  - \hypersetup {colorlinks = true, linkcolor = blue, urlcolor = blue}
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r echo=TRUE, message=FALSE, warning=FALSE}
# https://cran.r-project.org/web/packages/ggplot2/index.html
if (!require('ggplot2')) install.packages('ggplot2'); library('ggplot2')
# https://cran.r-project.org/web/packages/dplyr/index.html
if (!require('dplyr')) install.packages('dplyr'); library('dplyr')
```

## 1. Descripción del dataset.

**¿Qué conjunto de datos se ha utilizado?**

Para la realización de esta práctica se ha utilizado el conjunto de entrenamiento de *Titanic: Machine Learning from Disaster* (kaggle), el cual se puede encontrar en la siguiente [URL](https://www.kaggle.com/c/titanic/data). Se ha renombrado como "train_titanic.csv".

El conjunto de datos recoge información sobre los pasajeros a borde del Titanic cuando el buque chocó contra el iceberg:

* PassengerId: contiene el identificador numérico del pasajero.
* Survived [0, 1]: describe si el pasajero sobrevivió o no al hundimiento del buque.
* Pclass [1, 2, 3]: descibe la clase en la que viajaba el pasajero.
* Name: describe el nombre completo del pasajero.
* Sex [male, female]: describe el género del pasajero.
* Age: descibe la edad del pasajero en años.
* SibSp: describe el número de hermanos/as o esposos/as del pasajero a bordo del buque.
* ParCh: descibe el número de padres o hijos del pasajero a bordo del buque.
* Ticket: descibe el número de billete del pasajero.
* Fare: describe el precio del billete que llevaba el pasajero.
* Cabin: describe la cabina en la que viajaba el pasajero.
* Embarked [C, Q, S]: describe el puerto de embarque del pasajero.

Cada uno de los registros se corresponde con un único viajero.

Los datos del dataset son de tipo carácter o numérico, quedando excluidos otros tipos de variables.

**¿Por qué es importante y qué pregunta pretende responder?**

El conjunto tratado resulta relevante porque nos ayuda a comprender mejor el funcionamiento de la sociedad en 1912, permitiéndonos analizar la evolución hasta la época actual y encontrar potenciales puntos de mejora.

Los datos analizados pretenden dar respuesta a varias preguntas; entre ellas:
1. ¿Cómo se relacionan la clase, el género y la edad con la tasa de supervivencia?
2. ¿Cuántas personas viajaban solas? ¿Y con familia? ¿Cómo se relaciona esto con la tasa de supervivencia?
3. ¿Tiene algo que ver el puerto de embarque con la tasa de supervivencia?


## 2. Integración y selección de los datos de interés a analizar.

Como primer paso, realizamos la carga del conjunto a estudiar:

```{r}
titanic_data <-read.csv("./train_titanic.csv", header=T, sep=",", stringsAsFactors = FALSE, fileEncoding = "UTF-8", na.strings=c("NA", ""))
```

Calcularemos ahora las dimensiones del conjunto y analizaremos el tipo de variable correspondiente con cada columna:

```{r}
str(titanic_data)
```

Observamos que el fichero contiene 891 registros, correspondientes a las 12 variables descritas anteriormente (apartado 1):

- Categóricas: Survived, Pclass, Sex, Embarked
- Numéricas discretas: PassengerId, SibSp, ParCh
- Numéricas continuas: Age, Fare
- Texto: Name, Ticket, Cabin

Para el estudio a realizar no todas las variables serán necesarias. En concreto, las variables que no aportan información global, se eliminan: 
* PassengerId
* Name
* Ticket
* Cabin

```{r}
titanic_data <- select(titanic_data, -PassengerId, -Name, -Ticket, -Cabin)
```

Cambiamos el tipo de variables a Factor donde sea necesario:
 
```{r}
titanic_data$Survived <- as.factor(titanic_data$Survived)
titanic_data$Pclass <- as.factor(titanic_data$Pclass)
titanic_data$Sex <- as.factor(titanic_data$Sex)
titanic_data$Embarked <- as.factor(titanic_data$Embarked)
summary(titanic_data)
```

## 3. Limpieza de los datos.

### 3.1 Elementos vacíos.

Estudiaremos ahora si nuestros datos contienen elementos vacíos:

```{r}
colSums(is.na(titanic_data))
```

Observamos que tenemos elementos vacíos en las columnas "Age", "Cabin" y "Embarked":

- Age: Nos faltan 177 datos de los 891 registros (19,9%). Realizaremos una regresión en base al resto de variables para asociar una edad.
- Embarked: Nos faltan 2 datos de los 891 registros (0,2%). Evaluaremos si tiene sentido asumir que pertenecen a un determinado grupo (en función del resto de características); si no es posible categorizar a estos pasajeros, eliminaremos los registros.

### 3.2 Identificación y tratamiento de valores extremos.

Realizaremos un análisis de las variables numéricas continuas para detectar posibles valores extremos:

```{r}
boxplot(titanic_data$Age)
```

```{r}
boxplot(titanic_data$Fare)
```

Adicionalmente, analizaremos el histograma de las variables numéricas discretas para detectar posibles valores extremos:

```{r}
hist(titanic_data$SibSp)
```

```{r}
hist(titanic_data$Parch)
```

## 4. Análisis de los datos.

### 4.1 Selección de los grupos de datos que se quieren analizar/comparar (planificación de los análisis a aplicar).

### 4.2 Comprobación de la normalidad y homogeneidad de la varianza.

### 4.3 Aplicación de pruebas estadísticas para comparar los grupos de datos. En función de los datos y el objetivo del estudio, aplicar pruebas de contraste de hipótesis, correlaciones, regresiones, etc. Aplicar al menos tres métodos de análisis diferentes.


## 5. Representación de los resultados a partir de tablas y gráficas.



## 6. Resolución del problema. A partir de los resultados obtenidos, ¿cuáles son las conclusiones? ¿Los resultados permiten responder al problema?



## 7. Código.

El código utilizado para el análisis de la información se puede encontrar en la siguiente [URL](https://github.com/clobatoc21/TitanicSurvivalAnalyzer).


## Agradecimientos.

Los datos utilizados han sido recolectados del repositorio [Kaggle](https://www.kaggle.com/c/titanic/overview).

Por este motivo, ellos son los propietarios de los datos utilizados en esta práctica.


## Licencia.

Estos datos están sometidos a la licencia **Released Under CC BY-NC-SA 4.0 License**, la cual ofrece libertades a los usuarios a la par que derechos a los propietarios. Se permite su distribución, se reconoce al autor de la obra y se permite editar el código fuente. No obstante, no se permite lucrarse económicamente con el mismo ni privatizar el software con una licencia que altere las libertades anteriormente expuestas. El propietario de los datos será siempre Kaggle, y así deberá hacerse saber en cualquier utilización de los mismos.


## Tabla contribuciones

**Contribuciones** |**Firma** |
----------------------| ----------------------|
*Investigación Previa* | Carmen Lobato Cassinello, Raúl Vicente Ferrer |
*Redacción de las respuestas* | Carmen Lobato Cassinello, Raúl Vicente Ferrer |
*Desarrollo del código* | Carmen Lobato Cassinello, Raúl Vicente Ferrer 